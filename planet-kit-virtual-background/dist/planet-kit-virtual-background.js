!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.PlanetKitVirtualBackground=e():t.PlanetKitVirtualBackground=e()}(self,(()=>(()=>{var t={958:function(t,e,n){(function(){"use strict";var t;function e(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}var r="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){return t==Array.prototype||t==Object.prototype||(t[e]=n.value),t},i=function(t){t=["object"==typeof globalThis&&globalThis,t,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof n.g&&n.g];for(var e=0;e<t.length;++e){var r=t[e];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}(this);function o(t,e){if(e)t:{var n=i;t=t.split(".");for(var o=0;o<t.length-1;o++){var a=t[o];if(!(a in n))break t;n=n[a]}(e=e(o=n[t=t[t.length-1]]))!=o&&null!=e&&r(n,t,{configurable:!0,writable:!0,value:e})}}function a(t){return(t={next:t})[Symbol.iterator]=function(){return this},t}function u(t){var n="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return n?n.call(t):{next:e(t)}}function s(t){if(!(t instanceof Array)){t=u(t);for(var e,n=[];!(e=t.next()).done;)n.push(e.value);t=n}return t}o("Symbol",(function(t){function e(t,e){this.h=t,r(this,"description",{configurable:!0,writable:!0,value:e})}if(t)return t;e.prototype.toString=function(){return this.h};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",i=0;return function t(r){if(this instanceof t)throw new TypeError("Symbol is not a constructor");return new e(n+(r||"")+"_"+i++,r)}})),o("Symbol.iterator",(function(t){if(t)return t;t=Symbol("Symbol.iterator");for(var n="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),o=0;o<n.length;o++){var u=i[n[o]];"function"==typeof u&&"function"!=typeof u.prototype[t]&&r(u.prototype,t,{configurable:!0,writable:!0,value:function(){return a(e(this))}})}return t}));var l="function"==typeof Object.assign?Object.assign:function(t,e){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t};o("Object.assign",(function(t){return t||l}));var c,h="function"==typeof Object.create?Object.create:function(t){function e(){}return e.prototype=t,new e};if("function"==typeof Object.setPrototypeOf)c=Object.setPrototypeOf;else{var f;t:{var v={};try{v.__proto__={a:!0},f=v.a;break t}catch(t){}f=!1}c=f?function(t,e){if(t.__proto__=e,t.__proto__!==e)throw new TypeError(t+" is not extensible");return t}:null}var d=c;function p(t,e){if(t.prototype=h(e.prototype),t.prototype.constructor=t,d)d(t,e);else for(var n in e)if("prototype"!=n)if(Object.defineProperties){var r=Object.getOwnPropertyDescriptor(e,n);r&&Object.defineProperty(t,n,r)}else t[n]=e[n];t.za=e.prototype}function y(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function g(t){if(t.m)throw new TypeError("Generator is already running");t.m=!0}function m(t,e){t.l={ma:e,na:!0},t.h=t.s||t.v}function b(t,e,n){return t.h=n,{value:e}}function w(t){this.h=new y,this.i=t}function A(t,e,n,r){try{var i=e.call(t.h.j,n);if(!(i instanceof Object))throw new TypeError("Iterator result "+i+" is not an object");if(!i.done)return t.h.m=!1,i;var o=i.value}catch(e){return t.h.j=null,m(t.h,e),x(t)}return t.h.j=null,r.call(t.h,o),x(t)}function x(t){for(;t.h.h;)try{var e=t.i(t.h);if(e)return t.h.m=!1,{value:e.value,done:!1}}catch(e){t.h.i=void 0,m(t.h,e)}if(t.h.m=!1,t.h.l){if(e=t.h.l,t.h.l=null,e.na)throw e.ma;return{value:e.return,done:!0}}return{value:void 0,done:!0}}function E(t){this.next=function(e){return g(t.h),t.h.j?e=A(t,t.h.j.next,e,t.h.u):(t.h.u(e),e=x(t)),e},this.throw=function(e){return g(t.h),t.h.j?e=A(t,t.h.j.throw,e,t.h.u):(m(t.h,e),e=x(t)),e},this.return=function(e){return function(t,e){g(t.h);var n=t.h.j;return n?A(t,"return"in n?n.return:function(t){return{value:t,done:!0}},e,t.h.return):(t.h.return(e),x(t))}(t,e)},this[Symbol.iterator]=function(){return this}}function j(t){return function(t){function e(e){return t.next(e)}function n(e){return t.throw(e)}return new Promise((function(r,i){!function t(o){o.done?r(o.value):Promise.resolve(o.value).then(e,n).then(t,i)}(t.next())}))}(new E(new w(t)))}function k(t){return t||Array.prototype.fill}y.prototype.u=function(t){this.i=t},y.prototype.return=function(t){this.l={return:t},this.h=this.v},o("Promise",(function(t){function e(t){this.i=0,this.j=void 0,this.h=[],this.u=!1;var e=this.l();try{t(e.resolve,e.reject)}catch(t){e.reject(t)}}function n(){this.h=null}function r(t){return t instanceof e?t:new e((function(e){e(t)}))}if(t)return t;n.prototype.i=function(t){if(null==this.h){this.h=[];var e=this;this.j((function(){e.m()}))}this.h.push(t)};var o=i.setTimeout;n.prototype.j=function(t){o(t,0)},n.prototype.m=function(){for(;this.h&&this.h.length;){var t=this.h;this.h=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(t){this.l(t)}}}this.h=null},n.prototype.l=function(t){this.j((function(){throw t}))},e.prototype.l=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.I),reject:t(this.m)}},e.prototype.I=function(t){if(t===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.L(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.F(t):this.s(t)}},e.prototype.F=function(t){var e=void 0;try{e=t.then}catch(t){return void this.m(t)}"function"==typeof e?this.M(e,t):this.s(t)},e.prototype.m=function(t){this.v(2,t)},e.prototype.s=function(t){this.v(1,t)},e.prototype.v=function(t,e){if(0!=this.i)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.i);this.i=t,this.j=e,2===this.i&&this.K(),this.H()},e.prototype.K=function(){var t=this;o((function(){if(t.D()){var e=i.console;void 0!==e&&e.error(t.j)}}),1)},e.prototype.D=function(){if(this.u)return!1;var t=i.CustomEvent,e=i.Event,n=i.dispatchEvent;return void 0===n||("function"==typeof t?t=new t("unhandledrejection",{cancelable:!0}):"function"==typeof e?t=new e("unhandledrejection",{cancelable:!0}):(t=i.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,t),t.promise=this,t.reason=this.j,n(t))},e.prototype.H=function(){if(null!=this.h){for(var t=0;t<this.h.length;++t)a.i(this.h[t]);this.h=null}};var a=new n;return e.prototype.L=function(t){var e=this.l();t.T(e.resolve,e.reject)},e.prototype.M=function(t,e){var n=this.l();try{t.call(e,n.resolve,n.reject)}catch(t){n.reject(t)}},e.prototype.then=function(t,n){function r(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(t){o(t)}}:e}var i,o,a=new e((function(t,e){i=t,o=e}));return this.T(r(t,i),r(n,o)),a},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.T=function(t,e){function n(){switch(r.i){case 1:t(r.j);break;case 2:e(r.j);break;default:throw Error("Unexpected state: "+r.i)}}var r=this;null==this.h?a.i(n):this.h.push(n),this.u=!0},e.resolve=r,e.reject=function(t){return new e((function(e,n){n(t)}))},e.race=function(t){return new e((function(e,n){for(var i=u(t),o=i.next();!o.done;o=i.next())r(o.value).T(e,n)}))},e.all=function(t){var n=u(t),i=n.next();return i.done?r([]):new e((function(t,e){function o(e){return function(n){a[e]=n,0==--u&&t(a)}}var a=[],u=0;do{a.push(void 0),u++,r(i.value).T(o(a.length-1),e),i=n.next()}while(!i.done)}))},e})),o("Array.prototype.keys",(function(t){return t||function(){return function(t,e){t instanceof String&&(t+="");var n=0,r=!1,i={next:function(){if(!r&&n<t.length){var i=n++;return{value:e(i,t[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,(function(t){return t}))}})),o("Array.prototype.fill",(function(t){return t||function(t,e,n){var r=this.length||0;for(0>e&&(e=Math.max(0,r+e)),(null==n||n>r)&&(n=r),0>(n=Number(n))&&(n=Math.max(0,r+n)),e=Number(e||0);e<n;e++)this[e]=t;return this}})),o("Int8Array.prototype.fill",k),o("Uint8Array.prototype.fill",k),o("Uint8ClampedArray.prototype.fill",k),o("Int16Array.prototype.fill",k),o("Uint16Array.prototype.fill",k),o("Int32Array.prototype.fill",k),o("Uint32Array.prototype.fill",k),o("Float32Array.prototype.fill",k),o("Float64Array.prototype.fill",k),o("Object.is",(function(t){return t||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}})),o("Array.prototype.includes",(function(t){return t||function(t,e){var n=this;n instanceof String&&(n=String(n));var r=n.length;for(0>(e=e||0)&&(e=Math.max(e+r,0));e<r;e++){var i=n[e];if(i===t||Object.is(i,t))return!0}return!1}})),o("String.prototype.includes",(function(t){return t||function(t,e){if(null==this)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return-1!==this.indexOf(t,e||0)}}));var S=this||self;function O(t,e){t=t.split(".");var n,r=S;t[0]in r||void 0===r.execScript||r.execScript("var "+t[0]);for(;t.length&&(n=t.shift());)t.length||void 0===e?r=r[n]&&r[n]!==Object.prototype[n]?r[n]:r[n]={}:r[n]=e}function F(t){var e;return(e=S.navigator)&&(e=e.userAgent)||(e=""),-1!=e.indexOf(t)}var _=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=Array(n),i="string"==typeof t?t.split(""):t,o=0;o<n;o++)o in i&&(r[o]=e.call(void 0,i[o],o,t));return r},C={},T=null;function L(){if(!T){T={};for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++){var r=t.concat(e[n].split(""));C[n]=r;for(var i=0;i<r.length;i++){var o=r[i];void 0===T[o]&&(T[o]=i)}}}}var P="undefined"!=typeof Uint8Array,B=!(F("Trident")||F("MSIE"))&&"function"==typeof S.btoa;function I(t){if(!B){var e;void 0===e&&(e=0),L(),e=C[e];for(var n=Array(Math.floor(t.length/3)),r=e[64]||"",i=0,o=0;i<t.length-2;i+=3){var a=t[i],u=t[i+1],s=t[i+2],l=e[a>>2];a=e[(3&a)<<4|u>>4],u=e[(15&u)<<2|s>>6],s=e[63&s],n[o++]=l+a+u+s}switch(l=0,s=r,t.length-i){case 2:s=e[(15&(l=t[i+1]))<<2]||r;case 1:t=t[i],n[o]=e[t>>2]+e[(3&t)<<4|l>>4]+s+r}return n.join("")}for(e="";10240<t.length;)e+=String.fromCharCode.apply(null,t.subarray(0,10240)),t=t.subarray(10240);return e+=String.fromCharCode.apply(null,t),btoa(e)}var R,U=RegExp("[-_.]","g");function M(t){switch(t){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function N(t){if(!B)return function(t){var e=t.length,n=3*e/4;n%3?n=Math.floor(n):-1!="=.".indexOf(t[e-1])&&(n=-1!="=.".indexOf(t[e-2])?n-2:n-1);var r=new Uint8Array(n),i=0;return function(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=T[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}L();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),u=n(64);if(64===u&&-1===i)break;e(i<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=u&&e(a<<6&192|u))}}(t,(function(t){r[i++]=t})),i!==n?r.subarray(0,i):r}(t);U.test(t)&&(t=t.replace(U,M)),t=atob(t);for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}function V(){return R||(R=new Uint8Array(0))}var D={},G="function"==typeof Uint8Array.prototype.slice,W=0,z=0;function H(t){var e=0>t,n=(t=Math.abs(t))>>>0;t=Math.floor((t-n)/4294967296),e&&(e=(n=u(q(n,t))).next().value,t=n.next().value,n=e),W=n>>>0,z=t>>>0}var Y,X="function"==typeof BigInt;function q(t,e){return e=~e,t?t=1+~t:e+=1,[t,e]}function K(t,e){this.i=t>>>0,this.h=e>>>0}function J(t){if(!t)return Y||(Y=new K(0,0));if(!/^-?\d+$/.test(t))return null;if(16>t.length)H(Number(t));else if(X)t=BigInt(t),W=Number(t&BigInt(4294967295))>>>0,z=Number(t>>BigInt(32)&BigInt(4294967295));else{var e=+("-"===t[0]);z=W=0;for(var n=t.length,r=e,i=(n-e)%6+e;i<=n;r=i,i+=6)r=Number(t.slice(r,i)),z*=1e6,4294967296<=(W=1e6*W+r)&&(z+=W/4294967296|0,W%=4294967296);e&&(t=(e=u(q(W,z))).next().value,e=e.next().value,W=t,z=e)}return new K(W,z)}function Z(t,e){return Error("Invalid wire type: "+t+" (at position "+e+")")}function $(){return Error("Failed to read varint, encoding is invalid.")}function Q(t,e){return Error("Tried to read past the end of the data "+e+" > "+t)}function tt(){throw Error("Invalid UTF8")}function et(t,e){return e=String.fromCharCode.apply(null,e),null==t?e:t+e}var nt,rt,it,ot=void 0,at="undefined"!=typeof TextDecoder,ut="undefined"!=typeof TextEncoder;function st(t){if(t!==D)throw Error("illegal external caller")}function lt(t,e){if(st(e),this.V=t,null!=t&&0===t.length)throw Error("ByteString should be constructed with non-empty values")}function ct(){return it||(it=new lt(null,D))}function ht(t){st(D);var e=t.V;return null==(e=null==e||P&&null!=e&&e instanceof Uint8Array?e:"string"==typeof e?N(e):null)?e:t.V=e}function ft(t,e){this.i=null,this.m=!1,this.h=this.j=this.l=0,vt(this,t,e)}function vt(t,e,n){n=void 0===n?{}:n,t.S=void 0!==n.S&&n.S,e&&(e=function(t){if("string"==typeof t)return{buffer:N(t),C:!1};if(Array.isArray(t))return{buffer:new Uint8Array(t),C:!1};if(t.constructor===Uint8Array)return{buffer:t,C:!1};if(t.constructor===ArrayBuffer)return{buffer:new Uint8Array(t),C:!1};if(t.constructor===lt)return{buffer:ht(t)||V(),C:!0};if(t instanceof Uint8Array)return{buffer:new Uint8Array(t.buffer,t.byteOffset,t.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}(e),t.i=e.buffer,t.m=e.C,t.l=0,t.j=t.i.length,t.h=t.l)}function dt(t,e){if(t.h=e,e>t.j)throw Q(t.j,e)}function pt(t){var e=t.i,n=t.h,r=e[n++],i=127&r;if(128&r&&(i|=(127&(r=e[n++]))<<7,128&r&&(i|=(127&(r=e[n++]))<<14,128&r&&(i|=(127&(r=e[n++]))<<21,128&r&&(i|=(r=e[n++])<<28,128&r&&128&e[n++]&&128&e[n++]&&128&e[n++]&&128&e[n++]&&128&e[n++])))))throw $();return dt(t,n),i}function yt(t,e){if(0>e)throw Error("Tried to read a negative byte length: "+e);var n=t.h,r=n+e;if(r>t.j)throw Q(e,t.j-n);return t.h=r,n}ft.prototype.reset=function(){this.h=this.l};var gt=[];function mt(){this.h=[]}function bt(t,e,n){for(;0<n||127<e;)t.h.push(127&e|128),e=(e>>>7|n<<25)>>>0,n>>>=7;t.h.push(e)}function wt(t,e){for(;127<e;)t.h.push(127&e|128),e>>>=7;t.h.push(e)}function At(t,e){if(gt.length){var n=gt.pop();vt(n,t,e),t=n}else t=new ft(t,e);this.h=t,this.j=this.h.h,this.i=this.l=-1,this.setOptions(e)}function xt(t){var e=t.h;if(e.h==e.j)return!1;t.j=t.h.h;var n=pt(t.h)>>>0;if(e=n>>>3,!(0<=(n&=7)&&5>=n))throw Z(n,t.j);if(1>e)throw Error("Invalid field number: "+e+" (at position "+t.j+")");return t.l=e,t.i=n,!0}function Et(t){switch(t.i){case 0:if(0!=t.i)Et(t);else t:{for(var e=(t=t.h).h,n=e+10,r=t.i;e<n;)if(!(128&r[e++])){dt(t,e);break t}throw $()}break;case 1:dt(t=t.h,t.h+8);break;case 2:2!=t.i?Et(t):(e=pt(t.h)>>>0,dt(t=t.h,t.h+e));break;case 5:dt(t=t.h,t.h+4);break;case 3:for(e=t.l;;){if(!xt(t))throw Error("Unmatched start-group tag: stream EOF");if(4==t.i){if(t.l!=e)throw Error("Unmatched end-group tag");break}Et(t)}break;default:throw Z(t.i,t.j)}}mt.prototype.length=function(){return this.h.length},mt.prototype.end=function(){var t=this.h;return this.h=[],t},At.prototype.setOptions=function(t){t=void 0===t?{}:t,this.ca=void 0!==t.ca&&t.ca},At.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};var jt=[];function kt(){this.j=[],this.i=0,this.h=new mt}function St(t,e){0!==e.length&&(t.j.push(e),t.i+=e.length)}var Ot="function"==typeof Symbol&&"symbol"==typeof Symbol()?Symbol():void 0;function Ft(t,e){return Ot?t[Ot]|=e:void 0!==t.A?t.A|=e:(Object.defineProperties(t,{A:{value:e,configurable:!0,writable:!0,enumerable:!1}}),e)}function _t(t,e){Ot?t[Ot]&&(t[Ot]&=~e):void 0!==t.A&&(t.A&=~e)}function Ct(t){var e;return null==(e=Ot?t[Ot]:t.A)?0:e}function Tt(t,e){Ot?t[Ot]=e:void 0!==t.A?t.A=e:Object.defineProperties(t,{A:{value:e,configurable:!0,writable:!0,enumerable:!1}})}function Lt(t){return Ft(t,1),t}function Pt(t,e){Tt(e,-51&t)}function Bt(t,e){Tt(e,-41&t|18)}var It={};function Rt(t){return null!==t&&"object"==typeof t&&!Array.isArray(t)&&t.constructor===Object}var Ut,Mt,Nt=[];function Vt(t){if(2&Ct(t.o))throw Error("Cannot mutate an immutable Message")}function Dt(t){var e=t.length;(e=e?t[e-1]:void 0)&&Rt(e)?e.g=1:(e={},t.push((e.g=1,e)))}function Gt(t){var e=t.i+t.G;return t.B||(t.B=t.o[e]={})}function Wt(t,e){return-1===e?null:e>=t.i?t.B?t.B[e]:void 0:t.o[e+t.G]}function zt(t,e,n,r){Vt(t),Ht(t,e,n,r)}function Ht(t,e,n,r){t.j&&(t.j=void 0),e>=t.i||r?Gt(t)[e]=n:(t.o[e+t.G]=n,(t=t.B)&&e in t&&delete t[e])}function Yt(t,e,n,r){var i=Wt(t,e);Array.isArray(i)||(i=Ut);var o=Ct(i);if(1&o||Lt(i),r)2&o||Ft(i,2),1&n||Object.freeze(i);else{r=!(2&n);var a=2&o;1&n||!a?r&&16&o&&!a&&_t(i,16):Ht(t,e,i=Lt(Array.prototype.slice.call(i)))}return i}function Xt(t,e){var n=Wt(t,e),r=null==n?n:"number"==typeof n||"NaN"===n||"Infinity"===n||"-Infinity"===n?Number(n):void 0;return null!=r&&r!==n&&Ht(t,e,r),r}function qt(t,e,n,r,i){t.h||(t.h={});var o=t.h[n],a=Yt(t,n,3,i);if(!o){var u=a;o=[];var s=!!(16&Ct(t.o));a=!!(2&Ct(u));var l=u;!i&&a&&(u=Array.prototype.slice.call(u));for(var c=a,h=0;h<u.length;h++){var f=u[h],v=e,d=!1;if(d=void 0!==d&&d,void 0!==(f=Array.isArray(f)?new v(f):d?new v:void 0)){var p=d=Ct(v=f.o);a&&(p|=2),s&&(p|=16),p!=d&&Tt(v,p),v=p,c=c||!!(2&v),o.push(f)}}return t.h[n]=o,e=33|(s=Ct(u)),s!=(e=c?-9&e:8|e)&&(c=u,Object.isFrozen(c)&&(c=Array.prototype.slice.call(c)),Tt(c,e),u=c),l!==u&&Ht(t,n,u),(i||r&&a)&&Ft(o,2),r&&Object.freeze(o),o}return i||(i=Object.isFrozen(o),r&&!i?Object.freeze(o):!r&&i&&(o=Array.prototype.slice.call(o),t.h[n]=o)),o}function Kt(t,e,n){var r=!!(2&Ct(t.o));if(e=qt(t,e,n,r,r),t=Yt(t,n,3,r),!(r||8&Ct(t))){for(r=0;r<e.length;r++){if(2&Ct((n=e[r]).o)){var i=ue(n,!1);i.j=n}else i=n;n!==i&&(e[r]=i,t[r]=i.o)}Ft(t,8)}return e}function Jt(t,e,n){if(null!=n&&"number"!=typeof n)throw Error("Value of float/double field must be a number|null|undefined, found "+typeof n+": "+n);zt(t,e,n)}function Zt(t,e,n,r,i){Vt(t);var o=qt(t,n,e,!1,!1);return n=null!=r?r:new n,t=Yt(t,e,2,!1),null!=i?(o.splice(i,0,n),t.splice(i,0,n.o)):(o.push(n),t.push(n.o)),n.C()&&_t(t,8),n}function $t(t,e){return null==t?e:t}function Qt(t,e,n){return n=void 0===n?0:n,$t(Xt(t,e),n)}function te(t,e,n,r){if(null!=t){if(Array.isArray(t))t=ee(t,e,n,void 0!==r);else if(Rt(t)){var i,o={};for(i in t)o[i]=te(t[i],e,n,r);t=o}else t=e(t,r);return t}}function ee(t,e,n,r){var i=Ct(t);r=r?!!(16&i):void 0,t=Array.prototype.slice.call(t);for(var o=0;o<t.length;o++)t[o]=te(t[o],e,n,r);return n(i,t),t}function ne(t){return t.ja===It?t.toJSON():function(t){switch(typeof t){case"number":return isFinite(t)?t:String(t);case"object":if(t)if(Array.isArray(t)){if(128&Ct(t))return Dt(t=Array.prototype.slice.call(t)),t}else{if(P&&null!=t&&t instanceof Uint8Array)return I(t);if(t instanceof lt){var e=t.V;return null==e?"":"string"==typeof e?e:t.V=I(e)}}}return t}(t)}function re(t,e){128&t&&Dt(e)}function ie(t,e,n){if(n=void 0===n?Bt:n,null!=t){if(P&&t instanceof Uint8Array)return t.length?new lt(new Uint8Array(t),D):ct();if(Array.isArray(t)){var r=Ct(t);return 2&r?t:!e||32&r||!(16&r||0===r)?(4&(e=Ct(t=ee(t,ie,4&r?Bt:n,!0)))&&2&e&&Object.freeze(t),t):(Tt(t,2|r),t)}return t.ja===It?ae(t):t}}function oe(t,e,n,r,i,o,a){if(t=t.h&&t.h[n]){if(2&(r=Ct(t))?r=t:(Bt(r,o=_(t,ae)),Object.freeze(o),r=o),Vt(e),a=null==r?Ut:Lt([]),null!=r){for(o=!!r.length,t=0;t<r.length;t++){var u=r[t];o=o&&!(2&Ct(u.o)),a[t]=u.o}o=1|(o?8:0),((t=Ct(a))&o)!==o&&(Object.isFrozen(a)&&(a=Array.prototype.slice.call(a)),Tt(a,t|o)),e.h||(e.h={}),e.h[n]=r}else e.h&&(e.h[n]=void 0);Ht(e,n,a,i)}else zt(e,n,ie(r,o,a),i)}function ae(t){return 2&Ct(t.o)||Ft((t=ue(t,!0)).o,2),t}function ue(t,e){var n=t.o,r=[];Ft(r,16);var i=t.constructor.h;if(i&&r.push(i),i=t.B){r.length=n.length,r.fill(void 0,r.length,n.length);var o={};r[r.length-1]=o}128&Ct(n)&&Dt(r),e=e||t.C()?Bt:Pt,o=t.constructor,Mt=r,r=new o(r),Mt=void 0,t.R&&(r.R=t.R.slice()),o=!!(16&Ct(n));for(var a=i?n.length-1:n.length,u=0;u<a;u++)oe(t,r,u-t.G,n[u],!1,o,e);if(i)for(var s in i)oe(t,r,+s,i[s],!0,o,e);return r}function se(t,e,n){null==t&&(t=Mt),Mt=void 0;var r,i=this.constructor.i||0,o=0<i,a=this.constructor.h,u=!1;if(null==t){var s=48,l=!0;o&&(i=0,s|=128),Tt(t=a?[a]:[],s)}else{if(!Array.isArray(t))throw Error();if(a&&a!==t[0])throw Error();var c=s=Ft(t,0);if((l=!!(16&c))&&((u=!!(32&c))||(c|=32)),o){if(128&c)i=0;else if(0<t.length){var h=t[t.length-1];if(Rt(h)&&"g"in h){i=0,c|=128,delete h.g;var f,v=!0;for(f in h){v=!1;break}v&&t.pop()}}}else if(128&c)throw Error();s!==c&&Tt(t,c)}if(this.G=(a?0:-1)-i,this.h=void 0,this.o=t,i=(a=this.o.length)-1,a&&Rt(a=this.o[i])?(this.B=a,this.i=i-this.G):void 0!==e&&-1<e?(this.i=Math.max(e,i+1-this.G),this.B=void 0):this.i=Number.MAX_VALUE,!o&&this.B&&"g"in this.B)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(n)for(e=l&&!u&&!0,o=this.i,l=0;l<n.length;l++)(u=n[l])<o?(i=t[u+=this.G])?le(i,e):t[u]=Ut:(r||(r=Gt(this)),(i=r[u])?le(i,e):r[u]=Ut)}function le(t,e){if(Array.isArray(t)){var n=Ct(t),r=1;!e||2&n||(r|=16),(n&r)!==r&&Tt(t,n|r)}}function ce(t,e,n){if(n){var r,i={};for(r in n){var o=n[r],a=o.ra;a||(i.J=o.xa||o.oa.W,o.ia?(i.aa=me(o.ia),a=function(t){return function(e,n,r){return t.J(e,n,r,t.aa)}}(i)):o.ka?(i.Z=be(o.da.P,o.ka),a=function(t){return function(e,n,r){return t.J(e,n,r,t.Z)}}(i)):a=i.J,o.ra=a),a(e,t,o.da),i={J:i.J,aa:i.aa,Z:i.Z}}}!function(t,e){if(e=e.R){St(t,t.h.end());for(var n=0;n<e.length;n++)St(t,ht(e[n])||V())}}(e,t)}Tt(Nt,23),Ut=Object.freeze(Nt),se.prototype.toJSON=function(){return ee(this.o,ne,re)},se.prototype.C=function(){return!!(2&Ct(this.o))},se.prototype.ja=It,se.prototype.toString=function(){return this.o.toString()};var he=Symbol();function fe(t,e,n){return t[he]||(t[he]=function(t,r){return e(t,r,n)})}function ve(t){var e=t[he];if(!e){var n=Te(t);e=function(t,e){return Le(t,e,n)},t[he]=e}return e}function de(t){var e=function(t){var e=t.ia;return e?ve(e):(e=t.wa)?fe(t.da.P,e,t.ka):void 0}(t),n=t.da,r=t.oa.U;return e?function(t,i){return r(t,i,n,e)}:function(t,e){return r(t,e,n)}}function pe(t,e){var n=t[e];return"function"==typeof n&&0===n.length&&(n=n(),t[e]=n),Array.isArray(n)&&(Se in n||we in n||0<n.length&&"function"==typeof n[0])?n:void 0}function ye(t,e,n,r,i,o){e.P=t[0];var a=1;if(t.length>a&&"number"!=typeof t[a]){var u=t[a++];n(e,u)}for(;a<t.length;){n=t[a++];for(var s=a+1;s<t.length&&"number"!=typeof t[s];)s++;switch(u=t[a++],s-=a){case 0:r(e,n,u);break;case 1:(s=pe(t,a))?(a++,i(e,n,u,s)):r(e,n,u,t[a++]);break;case 2:i(e,n,u,s=pe(t,s=a++),t[a++]);break;case 3:o(e,n,u,t[a++],t[a++],t[a++]);break;case 4:o(e,n,u,t[a++],t[a++],t[a++],t[a++]);break;default:throw Error("unexpected number of binary field arguments: "+s)}}return e}var ge=Symbol();function me(t){var e=t[ge];if(!e){var n=ke(t);e=function(t,e){return Pe(t,e,n)},t[ge]=e}return e}function be(t,e){var n=t[ge];return n||(n=function(t,n){return ce(t,n,e)},t[ge]=n),n}var we=Symbol();function Ae(t,e){t.push(e)}function xe(t,e,n){t.push(e,n.W)}function Ee(t,e,n,r){var i=me(r),o=ke(r).P,a=n.W;t.push(e,(function(t,e,n){return a(t,e,n,o,i)}))}function je(t,e,n,r,i,o){var a=be(r,o),u=n.W;t.push(e,(function(t,e,n){return u(t,e,n,r,a)}))}function ke(t){var e=t[we];return e||(e=ye(t,t[we]=[],Ae,xe,Ee,je),Se in t&&we in t&&(t.length=0),e)}var Se=Symbol();function Oe(t,e){t[0]=e}function Fe(t,e,n,r){var i=n.U;t[e]=r?function(t,e,n){return i(t,e,n,r)}:i}function _e(t,e,n,r,i){var o=n.U,a=ve(r),u=Te(r).P;t[e]=function(t,e,n){return o(t,e,n,u,a,i)}}function Ce(t,e,n,r,i,o,a){var u=n.U,s=fe(r,i,o);t[e]=function(t,e,n){return u(t,e,n,r,s,a)}}function Te(t){var e=t[Se];return e||(e=ye(t,t[Se]={},Oe,Fe,_e,Ce),Se in t&&we in t&&(t.length=0),e)}function Le(t,e,n){for(;xt(e)&&4!=e.i;){var r=e.l,i=n[r];if(!i){var o=n[0];o&&(o=o[r])&&(i=n[r]=de(o))}if(!i||!i(e,t,r)){r=t,o=(i=e).j,Et(i);var a=i;if(!a.ca){if(i=a.h.h-o,a.h.h=o,a=a.h,0==i)i=ct();else{if(o=yt(a,i),a.S&&a.m)i=a.i.subarray(o,o+i);else{a=a.i;var u=o;i=u===(i=o+i)?V():G?a.slice(u,i):new Uint8Array(a.subarray(u,i))}i=0==i.length?ct():new lt(i,D)}(o=r.R)?o.push(i):r.R=[i]}}}return t}function Pe(t,e,n){for(var r=n.length,i=1==r%2,o=i?1:0;o<r;o+=2)(0,n[o+1])(e,t,n[o]);ce(t,e,i?n[0]:void 0)}function Be(t,e){return{U:t,W:e}}var Ie=Be((function(t,e,n){if(5!==t.i)return!1;var r=(t=t.h).i,i=t.h,o=r[i],a=r[i+1],u=r[i+2];return r=r[i+3],dt(t,t.h+4),t=2*((a=(o|a<<8|u<<16|r<<24)>>>0)>>31)+1,o=a>>>23&255,a&=8388607,zt(e,n,255==o?a?NaN:1/0*t:0==o?t*Math.pow(2,-149)*a:t*Math.pow(2,o-150)*(a+Math.pow(2,23))),!0}),(function(t,e,n){if(null!=(e=Xt(e,n))){wt(t.h,8*n+5),t=t.h;var r=+e;0===r?0<1/r?W=z=0:(z=0,W=2147483648):isNaN(r)?(z=0,W=2147483647):34028234663852886e22<(r=(n=0>r?-2147483648:0)?-r:r)?(z=0,W=(2139095040|n)>>>0):11754943508222875e-54>r?(r=Math.round(r/Math.pow(2,-149)),z=0,W=(n|r)>>>0):(e=Math.floor(Math.log(r)/Math.LN2),r*=Math.pow(2,-e),16777216<=(r=Math.round(8388608*r))&&++e,z=0,W=(n|e+127<<23|8388607&r)>>>0),n=W,t.h.push(n>>>0&255),t.h.push(n>>>8&255),t.h.push(n>>>16&255),t.h.push(n>>>24&255)}})),Re=Be((function(t,e,n){if(0!==t.i)return!1;var r=t.h,i=0,o=t=0,a=r.i,u=r.h;do{var s=a[u++];i|=(127&s)<<o,o+=7}while(32>o&&128&s);for(32<o&&(t|=(127&s)>>4),o=3;32>o&&128&s;o+=7)t|=(127&(s=a[u++]))<<o;if(dt(r,u),!(128>s))throw $();return r=i>>>0,(t=2147483648&(s=t>>>0))&&(s=~s>>>0,0==(r=1+~r>>>0)&&(s=s+1>>>0)),r=4294967296*s+(r>>>0),zt(e,n,t?-r:r),!0}),(function(t,e,n){null!=(e=Wt(e,n))&&("string"==typeof e&&J(e),null!=e&&(wt(t.h,8*n),"number"==typeof e?(t=t.h,H(e),bt(t,W,z)):(n=J(e),bt(t.h,n.i,n.h))))})),Ue=Be((function(t,e,n){return 0===t.i&&(zt(e,n,pt(t.h)),!0)}),(function(t,e,n){if(null!=(e=Wt(e,n))&&null!=e)if(wt(t.h,8*n),t=t.h,0<=(n=e))wt(t,n);else{for(e=0;9>e;e++)t.h.push(127&n|128),n>>=7;t.h.push(1)}})),Me=Be((function(t,e,n){if(2!==t.i)return!1;var r=pt(t.h)>>>0,i=yt(t=t.h,r);if(t=t.i,at){var o,a=t;(o=nt)||(o=nt=new TextDecoder("utf-8",{fatal:!0})),t=i+r,a=0===i&&t===a.length?a:a.subarray(i,t);try{var u=o.decode(a)}catch(t){if(void 0===ot){try{o.decode(new Uint8Array([128]))}catch(t){}try{o.decode(new Uint8Array([97])),ot=!0}catch(t){ot=!1}}throw!ot&&(nt=void 0),t}}else{r=(u=i)+r,i=[];for(var s,l,c=null;u<r;)128>(s=t[u++])?i.push(s):224>s?u>=r?tt():(l=t[u++],194>s||128!=(192&l)?(u--,tt()):i.push((31&s)<<6|63&l)):240>s?u>=r-1?tt():128!=(192&(l=t[u++]))||224===s&&160>l||237===s&&160<=l||128!=(192&(a=t[u++]))?(u--,tt()):i.push((15&s)<<12|(63&l)<<6|63&a):244>=s?u>=r-2?tt():128!=(192&(l=t[u++]))||l-144+(s<<28)>>30||128!=(192&(a=t[u++]))||128!=(192&(o=t[u++]))?(u--,tt()):(s=(7&s)<<18|(63&l)<<12|(63&a)<<6|63&o,s-=65536,i.push(55296+(s>>10&1023),56320+(1023&s))):tt(),8192<=i.length&&(c=et(c,i),i.length=0);u=et(c,i)}return zt(e,n,u),!0}),(function(t,e,n){if(null!=(e=Wt(e,n))){var r=!1;if(r=void 0!==r&&r,ut){if(r&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(e))throw Error("Found an unpaired surrogate");e=(rt||(rt=new TextEncoder)).encode(e)}else{for(var i=0,o=new Uint8Array(3*e.length),a=0;a<e.length;a++){var u=e.charCodeAt(a);if(128>u)o[i++]=u;else{if(2048>u)o[i++]=u>>6|192;else{if(55296<=u&&57343>=u){if(56319>=u&&a<e.length){var s=e.charCodeAt(++a);if(56320<=s&&57343>=s){u=1024*(u-55296)+s-56320+65536,o[i++]=u>>18|240,o[i++]=u>>12&63|128,o[i++]=u>>6&63|128,o[i++]=63&u|128;continue}a--}if(r)throw Error("Found an unpaired surrogate");u=65533}o[i++]=u>>12|224,o[i++]=u>>6&63|128}o[i++]=63&u|128}}e=i===o.length?o:o.subarray(0,i)}wt(t.h,8*n+2),wt(t.h,e.length),St(t,t.h.end()),St(t,e)}})),Ne=Be((function(t,e,n,r,i){if(2!==t.i)return!1;e=Zt(e,n,r),n=t.h.j,r=pt(t.h)>>>0;var o=t.h.h+r,a=o-n;if(0>=a&&(t.h.j=o,i(e,t,void 0,void 0,void 0),a=o-t.h.h),a)throw Error("Message parsing ended unexpectedly. Expected to read "+r+" bytes, instead read "+(r-a)+" bytes, either the data ended unexpectedly or the message misreported its own length");return t.h.h=o,t.h.j=n,!0}),(function(t,e,n,r,i){if(null!=(e=Kt(e,r,n)))for(r=0;r<e.length;r++){var o=t;wt(o.h,8*n+2);var a=o.h.end();St(o,a),a.push(o.i),o=a,i(e[r],t),a=t;var u=o.pop();for(u=a.i+a.h.length()-u;127<u;)o.push(127&u|128),u>>>=7,a.i++;o.push(u),a.i++}}));function Ve(t){return function(e,n){t:{if(jt.length){var r=jt.pop();r.setOptions(n),vt(r.h,e,n),e=r}else e=new At(e,n);try{var i=Te(t),o=Le(new i.P,e,i);break t}finally{(i=e.h).i=null,i.m=!1,i.l=0,i.j=0,i.h=0,i.S=!1,e.l=-1,e.i=-1,100>jt.length&&jt.push(e)}o=void 0}return o}}function De(t){return function(){var e=new kt;Pe(this,e,ke(t)),St(e,e.h.end());for(var n=new Uint8Array(e.i),r=e.j,i=r.length,o=0,a=0;a<i;a++){var u=r[a];n.set(u,o),o+=u.length}return e.j=[n],n}}function Ge(t){se.call(this,t)}p(Ge,se);var We=[Ge,1,Ue,2,Ie,3,Me,4,Me];function ze(t){se.call(this,t,-1,He)}Ge.prototype.l=De(We),p(ze,se),ze.prototype.addClassification=function(t,e){return Zt(this,1,Ge,t,e),this};var He=[1],Ye=Ve([ze,1,Ne,We]);function Xe(t){se.call(this,t)}p(Xe,se);var qe=[Xe,1,Ie,2,Ie,3,Ie,4,Ie,5,Ie];function Ke(t){se.call(this,t,-1,Je)}Xe.prototype.l=De(qe),p(Ke,se);var Je=[1],Ze=Ve([Ke,1,Ne,qe]);function $e(t){se.call(this,t)}p($e,se);var Qe=[$e,1,Ie,2,Ie,3,Ie,4,Ie,5,Ie,6,Re],tn=Ve(Qe);function en(t,e,n){if(n=t.createShader(0===n?t.VERTEX_SHADER:t.FRAGMENT_SHADER),t.shaderSource(n,e),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw Error("Could not compile WebGL shader.\n\n"+t.getShaderInfoLog(n));return n}function nn(t){return Kt(t,Ge,1).map((function(t){var e=Wt(t,1);return{index:null==e?0:e,qa:Qt(t,2),label:null!=Wt(t,3)?$t(Wt(t,3),""):void 0,displayName:null!=Wt(t,4)?$t(Wt(t,4),""):void 0}}))}function rn(t){return{x:Qt(t,1),y:Qt(t,2),z:Qt(t,3),visibility:null!=Xt(t,4)?Qt(t,4):void 0}}function on(t,e){this.i=t,this.h=e,this.m=0}function an(t,e,n){return function(t,e){var n=t.h;if(void 0===t.s){var r=en(n,"\n  attribute vec2 aVertex;\n  attribute vec2 aTex;\n  varying vec2 vTex;\n  void main(void) {\n    gl_Position = vec4(aVertex, 0.0, 1.0);\n    vTex = aTex;\n  }",0),i=en(n,"\n  precision mediump float;\n  varying vec2 vTex;\n  uniform sampler2D sampler0;\n  void main(){\n    gl_FragColor = texture2D(sampler0, vTex);\n  }",1),o=n.createProgram();if(n.attachShader(o,r),n.attachShader(o,i),n.linkProgram(o),!n.getProgramParameter(o,n.LINK_STATUS))throw Error("Could not compile WebGL program.\n\n"+n.getProgramInfoLog(o));r=t.s=o,n.useProgram(r),i=n.getUniformLocation(r,"sampler0"),t.l={O:n.getAttribLocation(r,"aVertex"),N:n.getAttribLocation(r,"aTex"),ya:i},t.v=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,t.v),n.enableVertexAttribArray(t.l.O),n.vertexAttribPointer(t.l.O,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),t.u=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,t.u),n.enableVertexAttribArray(t.l.N),n.vertexAttribPointer(t.l.N,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.uniform1i(i,0)}r=t.l,n.useProgram(t.s),n.canvas.width=e.width,n.canvas.height=e.height,n.viewport(0,0,e.width,e.height),n.activeTexture(n.TEXTURE0),t.i.bindTexture2d(e.glName),n.enableVertexAttribArray(r.O),n.bindBuffer(n.ARRAY_BUFFER,t.v),n.vertexAttribPointer(r.O,2,n.FLOAT,!1,0,0),n.enableVertexAttribArray(r.N),n.bindBuffer(n.ARRAY_BUFFER,t.u),n.vertexAttribPointer(r.N,2,n.FLOAT,!1,0,0),n.bindFramebuffer(n.DRAW_FRAMEBUFFER?n.DRAW_FRAMEBUFFER:n.FRAMEBUFFER,null),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.colorMask(!0,!0,!0,!0),n.drawArrays(n.TRIANGLE_FAN,0,4),n.disableVertexAttribArray(r.O),n.disableVertexAttribArray(r.N),n.bindBuffer(n.ARRAY_BUFFER,null),t.i.bindTexture2d(0)}(t,e),"function"==typeof t.h.canvas.transferToImageBitmap?Promise.resolve(t.h.canvas.transferToImageBitmap()):n?Promise.resolve(t.h.canvas):"function"==typeof createImageBitmap?createImageBitmap(t.h.canvas):(void 0===t.j&&(t.j=document.createElement("canvas")),new Promise((function(e){t.j.height=t.h.canvas.height,t.j.width=t.h.canvas.width,t.j.getContext("2d",{}).drawImage(t.h.canvas,0,0,t.h.canvas.width,t.h.canvas.height),e(t.j)})))}function un(t){this.h=t}$e.prototype.l=De(Qe);var sn=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function ln(t,e){return e+t}function cn(t,e){window[t]=e}function hn(t){if(this.h=t,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ga=!0,this.I=Promise.resolve(),this.fa="",this.D={},this.locateFile=t&&t.locateFile||ln,"object"==typeof window)var e=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else{if("undefined"==typeof location)throw Error("solutions can only be loaded on a web page or in a web worker");e=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/"}if(this.ha=e,t.options)for(var n=(e=u(Object.keys(t.options))).next();!n.done;n=e.next()){n=n.value;var r=t.options[n].default;void 0!==r&&(this.l[n]="function"==typeof r?r():r)}}function fn(t,e){var n,r;return j((function(i){return e in t.L?i.return(t.L[e]):(n=t.locateFile(e,""),r=fetch(n).then((function(t){return t.arrayBuffer()})),t.L[e]=r,i.return(r))}))}function vn(t,e){for(var n=e.name||"$",r=[].concat(s(e.wants)),i=new t.i.StringList,o=u(e.wants),a=o.next();!a.done;a=o.next())i.push_back(a.value);o=t.i.PacketListener.implement({onResults:function(i){for(var o={},a=0;a<e.wants.length;++a)o[r[a]]=i.get(a);var s=t.listeners[n];s&&(t.I=function(t,e,n){var r,i,o,a,s,l,c,h,f,v,d,p,y,g;return j((function(m){switch(m.h){case 1:if(!n)return m.return(e);for(r={},i=0,o=u(Object.keys(n)),a=o.next();!a.done;a=o.next())s=a.value,"string"!=typeof(l=n[s])&&"texture"===l.type&&void 0!==e[l.stream]&&++i;1<i&&(t.M=!1),c=u(Object.keys(n)),a=c.next();case 2:if(a.done){m.h=4;break}if(h=a.value,"string"==typeof(f=n[h]))return y=r,g=h,b(m,function(t,e,n){var r;return j((function(i){return"number"==typeof n||n instanceof Uint8Array||n instanceof t.i.Uint8BlobList?i.return(n):n instanceof t.i.Texture2dDataOut?((r=t.v[e])||(r=new on(t.i,t.K),t.v[e]=r),i.return(an(r,n,t.M))):i.return(void 0)}))}(t,h,e[f]),14);if(v=e[f.stream],"detection_list"===f.type){if(v){for(var w=v.getRectList(),A=v.getLandmarksList(),x=v.getClassificationsList(),E=[],k=0;k<w.size();++k){var S=tn(w.get(k)),O=void 0;O=void 0===O?0:O,S={la:{sa:Qt(S,1),ta:Qt(S,2),height:Qt(S,3),width:Qt(S,4),rotation:Qt(S,5,0),pa:$t(Wt(S,6),O)},ea:Kt(Ze(A.get(k)),Xe,1).map(rn),ba:nn(Ye(x.get(k)))},E.push(S)}w=E}else w=[];r[h]=w,m.h=7;break}if("proto_list"===f.type){if(v){for(w=Array(v.size()),A=0;A<v.size();A++)w[A]=v.get(A);v.delete()}else w=[];r[h]=w,m.h=7;break}if(void 0===v){m.h=3;break}if("float_list"===f.type){r[h]=v,m.h=7;break}if("proto"===f.type){r[h]=v,m.h=7;break}if("texture"!==f.type)throw Error("Unknown output config type: '"+f.type+"'");return(d=t.v[h])||(d=new on(t.i,t.K),t.v[h]=d),b(m,an(d,v,t.M),13);case 13:p=m.i,r[h]=p;case 7:f.transform&&r[h]&&(r[h]=f.transform(r[h])),m.h=3;break;case 14:y[g]=m.i;case 3:a=c.next(),m.h=2;break;case 4:return m.return(r)}}))}(t,o,e.outs).then((function(n){n=s(n);for(var i=0;i<e.wants.length;++i){var a=o[r[i]];"object"==typeof a&&a.hasOwnProperty&&a.hasOwnProperty("delete")&&a.delete()}n&&(t.I=n)})))}}),t.j.attachMultiListener(i,o),i.delete()}function dn(t){return void 0===t&&(t=0),1===t?"selfie_segmentation_landscape.tflite":"selfie_segmentation.tflite"}function pn(t){var e=this;t=t||{},this.h=new hn({locateFile:t.locateFile,files:function(t){return[{simd:!0,url:"selfie_segmentation_solution_simd_wasm_bin.js"},{simd:!1,url:"selfie_segmentation_solution_wasm_bin.js"},{data:!0,url:dn(t.modelSelection)}]},graph:{url:"selfie_segmentation.binarypb"},listeners:[{wants:["segmentation_mask","image_transformed"],outs:{image:{type:"texture",stream:"image_transformed"},segmentationMask:{type:"texture",stream:"segmentation_mask"}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:"object"==typeof window&&void 0!==window.navigator&&("iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document)},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},modelSelection:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelSelection",fieldName:"int_value"},onChange:function(t){var n,r,i;return j((function(o){return 1==o.h?(n=dn(t),r="third_party/mediapipe/modules/selfie_segmentation/"+n,b(o,fn(e.h,n),2)):(i=o.i,e.h.overrideFile(r,i),o.return(!0))}))}}}})}(t=hn.prototype).close=function(){return this.j&&this.j.delete(),Promise.resolve()},t.reset=function(){var t=this;return j((function(e){t.j&&(t.j.reset(),t.s={},t.v={}),e.h=0}))},t.setOptions=function(t,e){var n=this;if(e=e||this.h.options){for(var r=[],i=[],o={},a=u(Object.keys(t)),s=a.next();!s.done;o={X:o.X,Y:o.Y},s=a.next())if(!((s=s.value)in this.l)||this.l[s]!==t[s]){this.l[s]=t[s];var l=e[s];void 0!==l&&(l.onChange&&(o.X=l.onChange,o.Y=t[s],r.push(function(t){return function(){return j((function(e){if(1==e.h)return b(e,t.X(t.Y),2);!0===e.i&&(n.u=!0),e.h=0}))}}(o))),l.graphOptionXref&&(s=Object.assign({},{calculatorName:"",calculatorIndex:0},l.graphOptionXref,{valueNumber:1===l.type?t[s]:0,valueBoolean:0===l.type&&t[s],valueString:2===l.type?t[s]:""}),i.push(s)))}0===r.length&&0===i.length||(this.u=!0,this.H=(void 0===this.H?[]:this.H).concat(i),this.F=(void 0===this.F?[]:this.F).concat(r))}},t.initialize=function(){var t=this;return j((function(e){return 1==e.h?b(e,function(t){var e,n,r,i,o,a,u,l,c,h,f;return j((function(v){switch(v.h){case 1:return t.ga?(e=void 0===t.h.files?[]:"function"==typeof t.h.files?t.h.files(t.l):t.h.files,b(v,j((function(t){switch(t.h){case 1:return t.s=2,b(t,WebAssembly.instantiate(sn),4);case 4:t.h=3,t.s=0;break;case 2:return t.s=0,t.l=null,t.return(!1);case 3:return t.return(!0)}})),2)):v.return();case 2:if(n=v.i,"object"==typeof window)return cn("createMediapipeSolutionsWasm",{locateFile:t.locateFile}),cn("createMediapipeSolutionsPackedAssets",{locateFile:t.locateFile}),a=e.filter((function(t){return void 0!==t.data})),u=e.filter((function(t){return void 0===t.data})),l=Promise.all(a.map((function(e){var n=fn(t,e.url);if(void 0!==e.path){var r=e.path;n=n.then((function(e){return t.overrideFile(r,e),Promise.resolve(e)}))}return n}))),c=Promise.all(u.map((function(e){return void 0===e.simd||e.simd&&n||!e.simd&&!n?function(t){var e=document.createElement("script");return e.setAttribute("src",t),e.setAttribute("crossorigin","anonymous"),new Promise((function(t){e.addEventListener("load",(function(){t()}),!1),e.addEventListener("error",(function(){t()}),!1),document.body.appendChild(e)}))}(t.locateFile(e.url,t.ha)):Promise.resolve()}))).then((function(){var e,n,r;return j((function(i){if(1==i.h)return e=window.createMediapipeSolutionsWasm,n=window.createMediapipeSolutionsPackedAssets,r=t,b(i,e(n),2);r.i=i.i,i.h=0}))})),h=j((function(e){return t.h.graph&&t.h.graph.url?e=b(e,fn(t,t.h.graph.url),0):(e.h=0,e=void 0),e})),b(v,Promise.all([c,l,h]),7);if("function"!=typeof importScripts)throw Error("solutions can only be loaded on a web page or in a web worker");return r=e.filter((function(t){return void 0===t.simd||t.simd&&n||!t.simd&&!n})).map((function(e){return t.locateFile(e.url,t.ha)})),importScripts.apply(null,s(r)),i=t,b(v,createMediapipeSolutionsWasm(Module),6);case 6:i.i=v.i,t.m=new OffscreenCanvas(1,1),t.i.canvas=t.m,o=t.i.GL.createContext(t.m,{antialias:!1,alpha:!1,va:"undefined"!=typeof WebGL2RenderingContext?2:1}),t.i.GL.makeContextCurrent(o),v.h=4;break;case 7:if(t.m=document.createElement("canvas"),!(f=t.m.getContext("webgl2",{}))&&!(f=t.m.getContext("webgl",{})))return alert("Failed to create WebGL canvas context when passing video frame."),v.return();t.K=f,t.i.canvas=t.m,t.i.createContext(t.m,!0,!0,{});case 4:t.j=new t.i.SolutionWasm,t.ga=!1,v.h=0}}))}(t),2):3!=e.h?b(e,function(t){var e,n,r,i,o,a,s,l;return j((function(c){if(1==c.h)return t.h.graph&&t.h.graph.url&&t.fa===t.h.graph.url?c.return():(t.u=!0,t.h.graph&&t.h.graph.url?(t.fa=t.h.graph.url,b(c,fn(t,t.h.graph.url),3)):void(c.h=2));for(2!=c.h&&(e=c.i,t.j.loadGraph(e)),n=u(Object.keys(t.D)),r=n.next();!r.done;r=n.next())i=r.value,t.j.overrideFile(i,t.D[i]);if(t.D={},t.h.listeners)for(o=u(t.h.listeners),a=o.next();!a.done;a=o.next())s=a.value,vn(t,s);l=t.l,t.l={},t.setOptions(l),c.h=0}))}(t),3):b(e,function(t){var e,n,r,i,o,a;return j((function(s){switch(s.h){case 1:if(!t.u)return s.return();if(!t.F){s.h=2;break}e=u(t.F),n=e.next();case 3:if(n.done){s.h=5;break}return b(s,(0,n.value)(),4);case 4:n=e.next(),s.h=3;break;case 5:t.F=void 0;case 2:if(t.H){for(r=new t.i.GraphOptionChangeRequestList,i=u(t.H),o=i.next();!o.done;o=i.next())a=o.value,r.push_back(a);t.j.changeOptions(r),r.delete(),t.H=void 0}t.u=!1,s.h=0}}))}(t),0)}))},t.overrideFile=function(t,e){this.j?this.j.overrideFile(t,e):this.D[t]=e},t.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},t.send=function(t,e){var n,r,i,o,a,s,l,c,h,f=this;return j((function(v){switch(v.h){case 1:return f.h.inputs?(n=1e3*(null==e?performance.now():e),b(v,f.I,2)):v.return();case 2:return b(v,f.initialize(),3);case 3:for(r=new f.i.PacketDataList,i=u(Object.keys(t)),o=i.next();!o.done;o=i.next())if(a=o.value,s=f.h.inputs[a]){t:{var d=t[a];switch(s.type){case"video":var p=f.s[s.stream];if(p||(p=new on(f.i,f.K),f.s[s.stream]=p),0===p.m&&(p.m=p.i.createTexture()),"undefined"!=typeof HTMLVideoElement&&d instanceof HTMLVideoElement)var y=d.videoWidth,g=d.videoHeight;else"undefined"!=typeof HTMLImageElement&&d instanceof HTMLImageElement?(y=d.naturalWidth,g=d.naturalHeight):(y=d.width,g=d.height);g={glName:p.m,width:y,height:g},(y=p.h).canvas.width=g.width,y.canvas.height=g.height,y.activeTexture(y.TEXTURE0),p.i.bindTexture2d(p.m),y.texImage2D(y.TEXTURE_2D,0,y.RGBA,y.RGBA,y.UNSIGNED_BYTE,d),p.i.bindTexture2d(0),p=g;break t;case"detections":for((p=f.s[s.stream])||(p=new un(f.i),f.s[s.stream]=p),p.data||(p.data=new p.h.DetectionListData),p.data.reset(d.length),g=0;g<d.length;++g){y=d[g];var m=p.data,w=m.setBoundingBox,A=g,x=y.la,E=new $e;if(Jt(E,1,x.sa),Jt(E,2,x.ta),Jt(E,3,x.height),Jt(E,4,x.width),Jt(E,5,x.rotation),zt(E,6,x.pa),x=E.l(),w.call(m,A,x),y.ea)for(m=0;m<y.ea.length;++m){E=y.ea[m],A=(w=p.data).addNormalizedLandmark,x=g,E=Object.assign({},E,{visibility:E.visibility?E.visibility:0});var j=new Xe;Jt(j,1,E.x),Jt(j,2,E.y),Jt(j,3,E.z),E.visibility&&Jt(j,4,E.visibility),E=j.l(),A.call(w,x,E)}if(y.ba)for(m=0;m<y.ba.length;++m)A=(w=p.data).addClassification,x=g,E=y.ba[m],Jt(j=new Ge,2,E.qa),E.index&&zt(j,1,E.index),E.label&&zt(j,3,E.label),E.displayName&&zt(j,4,E.displayName),E=j.l(),A.call(w,x,E)}p=p.data;break t;default:p={}}}switch(l=p,c=s.stream,s.type){case"video":r.pushTexture2d(Object.assign({},l,{stream:c,timestamp:n}));break;case"detections":(h=l).stream=c,h.timestamp=n,r.pushDetectionList(h);break;default:throw Error("Unknown input config type: '"+s.type+"'")}}return f.j.send(r),b(v,f.I,4);case 4:r.delete(),v.h=0}}))},t.onResults=function(t,e){this.listeners[e||"$"]=t},O("Solution",hn),O("OptionType",{BOOL:0,NUMBER:1,ua:2,0:"BOOL",1:"NUMBER",2:"STRING"}),(t=pn.prototype).close=function(){return this.h.close(),Promise.resolve()},t.onResults=function(t){this.h.onResults(t)},t.initialize=function(){var t=this;return j((function(e){return b(e,t.h.initialize(),0)}))},t.reset=function(){this.h.reset()},t.send=function(t){var e=this;return j((function(n){return b(n,e.h.send(t),0)}))},t.setOptions=function(t){this.h.setOptions(t)},O("SelfieSegmentation",pn),O("VERSION","0.1.1675465747")}).call(this)}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r].call(o.exports,o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};return(()=>{"use strict";n.r(r),n.d(r,{default:()=>s});var t=n(958);function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function i(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */i=function(){return n};var t,n={},r=Object.prototype,o=r.hasOwnProperty,a=Object.defineProperty||function(t,e,n){t[e]=n.value},u="function"==typeof Symbol?Symbol:{},s=u.iterator||"@@iterator",l=u.asyncIterator||"@@asyncIterator",c=u.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,n){return t[e]=n}}function f(t,e,n,r){var i=e&&e.prototype instanceof b?e:b,o=Object.create(i.prototype),u=new L(r||[]);return a(o,"_invoke",{value:F(t,n,u)}),o}function v(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}n.wrap=f;var d="suspendedStart",p="suspendedYield",y="executing",g="completed",m={};function b(){}function w(){}function A(){}var x={};h(x,s,(function(){return this}));var E=Object.getPrototypeOf,j=E&&E(E(P([])));j&&j!==r&&o.call(j,s)&&(x=j);var k=A.prototype=b.prototype=Object.create(x);function S(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,n){function r(i,a,u,s){var l=v(t[i],t,a);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==e(h)&&o.call(h,"__await")?n.resolve(h.__await).then((function(t){r("next",t,u,s)}),(function(t){r("throw",t,u,s)})):n.resolve(h).then((function(t){c.value=t,u(c)}),(function(t){return r("throw",t,u,s)}))}s(l.arg)}var i;a(this,"_invoke",{value:function(t,e){function o(){return new n((function(n,i){r(t,e,n,i)}))}return i=i?i.then(o,o):o()}})}function F(e,n,r){var i=d;return function(o,a){if(i===y)throw Error("Generator is already running");if(i===g){if("throw"===o)throw a;return{value:t,done:!0}}for(r.method=o,r.arg=a;;){var u=r.delegate;if(u){var s=_(u,r);if(s){if(s===m)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=y;var l=v(e,n,r);if("normal"===l.type){if(i=r.done?g:p,l.arg===m)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(i=g,r.method="throw",r.arg=l.arg)}}}function _(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,_(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var o=v(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var a=o.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function P(n){if(n||""===n){var r=n[s];if(r)return r.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var i=-1,a=function e(){for(;++i<n.length;)if(o.call(n,i))return e.value=n[i],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(e(n)+" is not iterable")}return w.prototype=A,a(k,"constructor",{value:A,configurable:!0}),a(A,"constructor",{value:w,configurable:!0}),w.displayName=h(A,c,"GeneratorFunction"),n.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,A):(t.__proto__=A,h(t,c,"GeneratorFunction")),t.prototype=Object.create(k),t},n.awrap=function(t){return{__await:t}},S(O.prototype),h(O.prototype,l,(function(){return this})),n.AsyncIterator=O,n.async=function(t,e,r,i,o){void 0===o&&(o=Promise);var a=new O(f(t,e,r,i),o);return n.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},S(k),h(k,c,"Generator"),h(k,s,(function(){return this})),h(k,"toString",(function(){return"[object Generator]"})),n.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},n.values=P,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(r,i){return u.type="throw",u.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=o.call(a,"catchLoc"),l=o.call(a,"finallyLoc");if(s&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:P(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},n}function o(t,e,n,r,i,o,a){try{var u=t[o](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,i)}function a(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function u(t){o(a,r,i,u,s,"next",t)}function s(t){o(a,r,i,u,s,"throw",t)}u(void 0)}))}}function u(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}const s=function(){return e=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.isSafari()?console.warn("Virtual background is not supported in Safari browsers."):(this.videoElement=null,this.canvasElement=null,this.canvasCtx=null,this.selfieSegmentation=null,this.config=null,this.requestAnimationId=null,this.worker=null,this.workerActive=!1,this.init(e))},n=[{key:"init",value:function(e){var n=this,r=Object.assign({locateFile:"cdn"},e);this.selfieSegmentation=new t.SelfieSegmentation({locateFile:function(t){return"cdn"===t.locateFile?function(t){return"https://cdn.jsdelivr.net/npm/@mediapipe/selfie_segmentation/".concat(t)}:function(e){return"./".concat(t.locateFile,"/").concat(e)}}(r)}),this.selfieSegmentation.setOptions({modelSelection:1}),this.selfieSegmentation.onResults(this.onResults.bind(this));var o=new Blob(["\n                let intervalId = null;\n                self.onmessage = function(event) {\n                    const { type, interval } = event.data;\n                    if (type === 'start') {\n                        if (!intervalId) {\n                            const sendPing = () => {\n                                self.postMessage('ping');\n                            };\n                            intervalId = setInterval(sendPing, interval);\n                        }\n                    } else if (type === 'stop') {\n                        if (intervalId) {\n                            clearInterval(intervalId);\n                            intervalId = null;\n                        }\n                    }\n                };\n                "],{type:"application/javascript"}),u=URL.createObjectURL(o);this.worker=new Worker(u),this.worker.onmessage=function(){var t=a(i().mark((function t(e){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("ping"!==e.data||!n.videoElement){t.next=4;break}if(n.videoElement.readyState!==n.videoElement.HAVE_ENOUGH_DATA){t.next=4;break}return t.next=4,n.selfieSegmentation.send({image:n.videoElement});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),document.addEventListener("visibilitychange",this.handleVisibilityChange.bind(this))}},{key:"handleVisibilityChange",value:function(){this.isActive()&&("visible"===document.visibilityState?this.startVirtualBackground():"hidden"===document.visibilityState&&this.startVirtualBackgroundByWorker())}},{key:"startVirtualBackgroundBlur",value:(s=a(i().mark((function t(e,n){var r,o=arguments;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=o.length>2&&void 0!==o[2]?o[2]:15,this.setMediaElement(e,n),this.setConfig({type:"blur",blurRadius:r}),this.startVirtualBackground();case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return s.apply(this,arguments)})},{key:"startVirtualBackgroundImage",value:(o=a(i().mark((function t(e,n,r){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.setMediaElement(e,n),this.setConfig({type:"image",backgroundImage:r}),this.startVirtualBackground();case 3:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return o.apply(this,arguments)})},{key:"startVirtualBackground",value:(r=a(i().mark((function t(){var e,n=this;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.isActive&&this.stopVirtualBackground(),e=function(){var t=a(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.videoElement.readyState!==n.videoElement.HAVE_ENOUGH_DATA){t.next=3;break}return t.next=3,n.selfieSegmentation.send({image:n.videoElement});case 3:n.requestAnimationId=requestAnimationFrame(e);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),e();case 3:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"startVirtualBackgroundByWorker",value:function(){this.isActive&&this.stopVirtualBackground(),this.workerActive||(this.worker.postMessage({type:"start",interval:33}),this.workerActive=!0)}},{key:"stopVirtualBackground",value:function(){this.requestAnimationId&&(cancelAnimationFrame(this.requestAnimationId),this.requestAnimationId=null),this.workerActive&&(this.worker.postMessage({type:"stop"}),this.workerActive=!1),this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}},{key:"changeVideoSource",value:function(t){this.videoElement=t}},{key:"changeOutputCanvas",value:function(t){this.canvasElement=t,this.updateCanvasSize(),this.canvasCtx=t.getContext("2d")}},{key:"getVirtualBackgroundVideoStream",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;return this.canvasElement.captureStream(t)}},{key:"isActive",value:function(){return null!==this.requestAnimationId||this.workerActive}},{key:"release",value:function(){this.stopVirtualBackground(),document.removeEventListener("visibilitychange",this.handleVisibilityChange),this.worker&&(this.worker.terminate(),this.worker=null),this.canvasCtx&&(this.canvasCtx.clearRect(0,0,this.canvasElement.width,this.canvasElement.height),this.canvasCtx=null),this.videoElement=null,this.canvasElement=null,this.selfieSegmentation=null,this.config=null}},{key:"isSafari",value:function(){var t=navigator.userAgent.toLowerCase(),e=t.includes("safari")&&!t.includes("chrome"),n=/iphone|ipad|ipod/.test(t),r=t.includes("macintosh")&&e;return e||n||r}},{key:"setConfig",value:function(t){this.config=t}},{key:"setMediaElement",value:function(t,e){this.videoElement=t,this.canvasElement=e,this.updateCanvasSize(),this.canvasCtx=e.getContext("2d")}},{key:"updateCanvasSize",value:function(){var t,e,n,r,i,o,a,u,s=this;null!==(t=this.videoElement)&&void 0!==t&&t.videoWidth&&null!==(e=this.videoElement)&&void 0!==e&&e.videoHeight?(null===(n=this.videoElement)||void 0===n?void 0:n.videoWidth)<10&&(null===(r=this.videoElement)||void 0===r?void 0:r.videoHeight)<10?setTimeout((function(){s.updateCanvasSize()}),500):(this.canvasElement.width=(null===(i=this.videoElement)||void 0===i?void 0:i.videoWidth)<640?null===(o=this.videoElement)||void 0===o?void 0:o.videoWidth:640,this.canvasElement.height=(null===(a=this.videoElement)||void 0===a?void 0:a.videoHeight)<360?null===(u=this.videoElement)||void 0===u?void 0:u.videoHeight:360):this.videoElement.addEventListener("loadedmetadata",(function t(){s.updateCanvasSize(),s.videoElement.removeEventListener("loadedmetadata",t)}))}},{key:"onResults",value:function(t){if(this.canvasCtx.save(),this.canvasCtx.clearRect(0,0,this.canvasElement.width,this.canvasElement.height),this.canvasCtx.drawImage(t.image,0,0,this.canvasElement.width,this.canvasElement.height),this.canvasCtx.globalCompositeOperation="destination-in",this.canvasCtx.drawImage(t.segmentationMask,0,0,this.canvasElement.width,this.canvasElement.height),"blur"===this.config.type)this.canvasCtx.globalCompositeOperation="destination-over",this.canvasCtx.filter="blur(".concat(this.config.blurRadius,"px)"),this.canvasCtx.drawImage(t.image,0,0,this.canvasElement.width,this.canvasElement.height);else if("image"===this.config.type){var e=this.config.backgroundImage;this.canvasCtx.globalCompositeOperation="destination-over",this.canvasCtx.drawImage(e,0,0,this.canvasElement.width,this.canvasElement.height)}this.canvasCtx.restore()}}],n&&function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,u(r.key),r)}}(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,r,o,s}()})(),r})()));